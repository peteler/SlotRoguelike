graph TB
    subgraph "Main Game Scenes"
        Battle[Battle Scene<br/>ğŸ“ Main Game Loop]
        Menu[Menu Scene<br/>ğŸ® Navigation]
        Shop[Shop Scene<br/>ğŸ›’ Upgrades]
    end

    subgraph "Battle Scene Hierarchy"
        Battle --> BM[BattleManager<br/>ğŸ¯ Core State Controller]
        Battle --> UI[UI Container<br/>ğŸ–¥ï¸ User Interface]
        Battle --> World[World Container<br/>ğŸŒ Game Objects]
        
        UI --> SM[SlotMachine<br/>ğŸ° Roll System]
        UI --> ActionPanel[Action Panel<br/>âš”ï¸ Combat Controls]
        UI --> StatsDisplay[Stats Display<br/>ğŸ“Š Current Stats]
        
        SM --> SlotContainer[Slot Container<br/>ğŸ“¦ HBoxContainer]
        SM --> RollBtn[Roll Button<br/>ğŸ² Trigger Roll]
        SlotContainer --> Slot1[Slot Instance<br/>ğŸ¯ Individual Slot]
        SlotContainer --> Slot2[Slot Instance<br/>ğŸ¯ Individual Slot]
        SlotContainer --> SlotN[Slot Instance...<br/>ğŸ¯ Dynamic Count]
        
        ActionPanel --> AttackBtn[Attack Button<br/>âš”ï¸ Direct Attack]
        ActionPanel --> SpellPanel[Spell Panel<br/>âœ¨ Magic Actions]
        ActionPanel --> EndTurnBtn[End Turn Button<br/>â­ï¸ Finish Turn]
        
        World --> PlayerChar[Player Character<br/>ğŸ›¡ï¸ Knight/Hero]
        World --> EnemyContainer[Enemy Container<br/>ğŸ‘¹ All Enemies]
        EnemyContainer --> Enemy1[Enemy Instance<br/>ğŸ‰ AI Opponent]
        EnemyContainer --> Enemy2[Enemy Instance<br/>ğŸ‰ AI Opponent]
    end

    subgraph "Individual Slot Scene"
        SlotScene[Slot.tscn<br/>ğŸ¯ Reusable Component]
        SlotScene --> SlotControl[Control Node<br/>ğŸ“¦ Root Container]
        SlotControl --> PanelContainer[Panel Container<br/>ğŸ–¼ï¸ Visual Frame]
        PanelContainer --> TextureRect[Texture Rect<br/>ğŸ–¼ï¸ Symbol Display]
        SlotScene --> SlotScript[Slot.gd<br/>ğŸ“ Symbol Management]
    end

    subgraph "Character Scene Template"
        CharScene[Character.tscn<br/>ğŸ‘¤ Base Template]
        CharScene --> CharArea[Area2D<br/>ğŸ¯ Targeting & Collision]
        CharScene --> CharSprite[Sprite2D<br/>ğŸ–¼ï¸ Visual Representation]
        CharScene --> CharUI[Character UI<br/>ğŸ“Š Health/Stats Display]
        CharScene --> CharScript[Character.gd<br/>ğŸ“ Base Logic]
        
        PlayerChar -.->|inherits| CharScene
        Enemy1 -.->|inherits| CharScene
    end

    subgraph "Data Systems & Resources"
        SymbolData[SymbolData.tres<br/>ğŸ“„ Symbol Definitions]
        SymbolPool[SymbolPool.gd<br/>ğŸ² Finite Pool Manager]
        SpellData[Spell Resources<br/>âœ¨ Magic Definitions]
        CharStats[Character Stats<br/>ğŸ“Š Progression Data]
    end

    subgraph "Core System Scripts"
        BM --> StateManager{State Machine<br/>ğŸ”„ Turn Flow}
        BM --> TargetSystem[Targeting System<br/>ğŸ¯ Selection Logic]
        BM --> CombatResolver[Combat Resolver<br/>âš”ï¸ Damage Calculation]
        
        SM --> SymbolPool
        SM --> RollLogic[Roll Logic<br/>ğŸ° Sequential Processing]
        
        StateManager --> PlayerRoll[PLAYER_ROLL<br/>ğŸ² Awaiting Roll]
        StateManager --> PlayerAction[PLAYER_ACTION<br/>âš”ï¸ Choose Action]
        StateManager --> PlayerTarget[PLAYER_TARGETING<br/>ğŸ¯ Select Target]
        StateManager --> EnemyTurn[ENEMY_TURN<br/>ğŸ¤– AI Processing]
        StateManager --> BattleEnd[BATTLE_END<br/>ğŸ† Victory/Defeat]
    end

    subgraph "Signal Flow Architecture"
        direction LR
        SignalEmitters[Signal Emitters<br/>ğŸ“¡ Event Sources]
        SignalReceivers[Signal Receivers<br/>ğŸ“» Event Handlers]
        
        SignalEmitters --> |roll_completed| SM
        SignalEmitters --> |targeted| PlayerChar
        SignalEmitters --> |health_updated| CharUI
        SignalEmitters --> |button_pressed| ActionPanel
        
        SignalReceivers --> |_on_roll_completed| BM
        SignalReceivers --> |_on_enemy_targeted| BM
        SignalReceivers --> |_on_health_changed| StatsDisplay
        SignalReceivers --> |_on_action_selected| BM
    end

    subgraph "Future Expansion Areas"
        EquipSystem[Equipment System<br/>âš”ï¸ Gear & Items]
        ProgressSystem[Progression System<br/>ğŸ“ˆ Unlocks & Upgrades]
        SaveSystem[Save System<br/>ğŸ’¾ Persistence]
        AudioSystem[Audio System<br/>ğŸ”Š Sound & Music]
        EffectSystem[Effect System<br/>âœ¨ Animations & VFX]
        
        EquipSystem -.->|enhances| PlayerChar
        ProgressSystem -.->|modifies| SymbolPool
        SaveSystem -.->|persists| CharStats
    end

    %% Styling
    classDef sceneNode fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    classDef systemNode fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef dataNode fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef uiNode fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef futureNode fill:#fce4ec,stroke:#c2185b,stroke-width:2px,stroke-dasharray: 5 5

    class Battle,Menu,Shop,CharScene,SlotScene sceneNode
    class BM,StateManager,TargetSystem,CombatResolver,RollLogic systemNode
    class SymbolData,SymbolPool,SpellData,CharStats dataNode
    class UI,SM,ActionPanel,StatsDisplay,SlotContainer uiNode
    class EquipSystem,ProgressSystem,SaveSystem,AudioSystem,EffectSystem futureNode